var o=(l,d)=>{l||(l=".filebokz"),typeof d!="string"&&(d="filebokz");let f=["apng","bmp","gif","x-icon","jpeg","png","svg+xml","tiff","webp"],b=["kB","MB","GB","TB","PB","EB","ZB","YB"],z=document.createElement("div"),A="draggable"in z||"ondragstart"in z&&"ondrop"in z,N="FormData"in window&&"FileReader"in window;o.count||(o.count=0),typeof l=="string"?l=document.querySelectorAll(l):l instanceof HTMLElement&&(l=[l]);let M=(t,e,s)=>{let n=t.querySelector(".error-msg"),r=t.dataset.errorDisplayDuration||3e3;t.classList.add("error");let c=t.dataset,a="";if(e==="maxFiles"&&(a=c.maxFilesErrorMsg||"A maximum of {variable} file{s} can be uploaded.",a=a.replace(/{variable}/ig,s),a=a.replace(/{s}/ig,s>1?"s":"")),e==="maxFileSize"&&(a=c.maxFileSizeErrorMsg||"File size cannot exceed {variable}.",a=a.replace(/{variable}/ig,T(s))),e==="maxSize"&&(a=c.maxSizeErrorMsg||"Total combined file size cannot exceed {variable}.",a=a.replace(/{variable}/ig,T(s))),e==="allowedExtensions"&&(a=c.allowedExtensionsErrorMsg||"Only the following file types are allowed: {variable}.",a=a.replace(/{variable}/ig,s)),n){n.innerHTML=a;let p=250;Object.prototype.hasOwnProperty.call(t.dataset,"errorAnimationDuration")&&(p=t.dataset.errorAnimationDuration),setTimeout(function(){n.innerHTML=""},r+p)}setTimeout(function(){t.classList.remove("error")},r),o.triggerEvent("error",t,{errorMessage:a,errorType:e})},D=(t,e,s,n)=>{if(Object.prototype.hasOwnProperty.call(t,e+n))return t[e+n];if(Object.prototype.hasOwnProperty.call(t,e+s))return t[e+s]},T=t=>{if(Math.abs(t)<1024)return t+" B";let e=-1;do t/=1024,++e;while(Math.round(Math.abs(t)*10)/10>=1024&&e<b.length-1);return+t.toFixed(1)+" "+b[e]},W=(t,e)=>{e.classList.remove("in-focus")},C=(t,e,s)=>{let n=s.files,r=s.originalFiles||[],c=t.filebokzAction==="remove";if(n.length){let i=!e.dataset.appendable||e.dataset.appendable.toLowerCase()!=="false",g=s.hasAttribute("multiple")&&s.getAttribute("multiple").toLowerCase()!=="false";if(i&&g&&!c&&r.length){let v=Array.from(n),h=Array.from(r);for(let m=0;m<v.length;m++){let k=!1;for(let u=0;u<h.length;u++)v[m].lastModifed===h[u].lastModifed&&v[m].name===h[u].name&&v[m].size===h[u].size&&v[m].type===h[u].type&&(k=!0);k||h.push(v[m])}s.files=o.newFileList(h),n=s.files}H(n,e,s)?e.classList.add("has-files"):n=[]}!n.length&&!c&&(s.files=o.newFileList(r),n=s.files),n.length||e.classList.remove("has-files"),s.originalFiles=n,e.dataset.fileCount=n.length;let a=e.querySelector(".file-count");a&&(a.innerHTML=n.length);let p=0;for(let i=0;i<n.length;i++)p+=n[i].size;e.dataset.size=p;let w=e.querySelector(".size");w&&(w.innerHTML=T(p));let E=e.querySelector(".files");if(E){let i=E.dataset,g=E.querySelectorAll(".file");if(g)for(let v=0;v<g.length;v++)E.removeChild(g[v]);if(n.length){let v=!i.draggable||i.draggable.toLowerCase()!=="false";for(let h=0;h<n.length;h++)(function(m,k){let u=m.type.split("/")[0],S=m.type.replace(/[/+-](\w{1})/g,function(y){return y.toUpperCase()}).replace(/[/+-]/g,"");u=u.charAt(0).toUpperCase()+u.slice(1);let O=D(i,"element",u,S);O=O||i.element||"span";let L=D(i,"content",u,S);L=L||i.content||"{name}";let j=D(i,"contentBefore",u,S);j=j||i.contentBefore||"";let q=D(i,"contentAfter",u,S);q=q||i.contentAfter||"";let I=D(i,"url",u,S);I||(f.includes(m.type.replace("image/",""))?I=window.URL.createObjectURL(m):I=i.url||""),L=j+L+q,L=L.replace(/{name}/ig,m.name),L=L.replace(/{type}/ig,m.type),L=L.replace(/{size}/ig,T(m.size)),L=L.replace(/{url}/ig,I);let F=document.createElement(O);F.className="file",F.innerHTML=L,A&&v&&(F.draggable="true",F.addEventListener("drag",function(y){X(y,e.id)},!1),F.addEventListener("dragstart",function(y){Z(y,e.id)},!1));let R=F.querySelector(".remove");R&&R.addEventListener("click",function(y){$(y,s,k)},!1),E.append(F)})(n[h],h)}}n.length>r.length?o.triggerEvent("file-added",e):n.length<r.length&&o.triggerEvent("file-removed",e)},P=(t,e,s)=>{t.preventDefault(),t.stopPropagation(),e.classList.add("is-dragging")},Y=(t,e)=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("is-dragging")},G=(t,e,s)=>{t.preventDefault(),t.stopPropagation(),e.classList.remove("is-dragging");let n=t.dataTransfer.files,r=t.dataTransfer.getData("fileBoxId");if(r){let c=t.dataTransfer.getData("fileIndex"),a=document.getElementById(r),p=a.querySelector("input"),w=a.querySelector(".files").children[c];if(a.classList.remove("is-dragging"),a.classList.remove("is-removing"),a.classList.remove("is-transferring"),w.classList.remove("is-dragging"),w.classList.remove("is-removing"),w.classList.remove("is-transferring"),r===e.id)return;let E=Array.from(p.files),i=E[c],g=Array.from(s.files);s.hasAttribute("multiple")&&s.getAttribute("multiple").toLowerCase()!=="false"?g.push(i):g=[i],H(g,e,s)&&(n=o.newFileList(g),E.splice(c,1),p.files=o.newFileList(E),o.triggerEvent("change",p,{filebokzAction:"remove"}))}n&&n.length&&(s.files=n,o.triggerEvent("change",s))},X=(t,e)=>{t.preventDefault(),t.stopPropagation();let s=document.elementFromPoint(t.pageX,t.pageY);if(s){let n=document.getElementById(e),r=s.closest("[filebokz-id]");r&&r.classList.contains("js-enabled")?(r.id!==e&&(t.target.classList.add("is-transferring"),n.classList.add("is-transferring")),t.target.classList.remove("is-removing"),n.classList.remove("is-removing")):(t.target.classList.add("is-removing"),n.classList.add("is-removing"),t.target.classList.remove("is-transferring"),n.classList.remove("is-transferring"))}},Z=(t,e,s)=>{t.target.classList.add("is-dragging");let n=Array.from(t.target.parentNode.children).indexOf(t.target);t.dataTransfer.setData("fileBoxId",e),t.dataTransfer.setData("fileIndex",n)},$=(t,e,s)=>{t.preventDefault(),t.stopPropagation(),o.removeFiles(e,s)},J=(t,e)=>{e.classList.add("in-focus")},K=(t,e,s)=>{let n=e.querySelector(".error");n&&(n.innerHTML=""),e.classList.remove("error"),o.triggerEvent("change",s)},Q=(t,e)=>{e.classList.add("is-uploading")},V=t=>{t.preventDefault()},_=t=>{t.preventDefault(),t.stopImmediatePropagation();let e=t.dataTransfer.getData("fileBoxId");if(e){let n=document.getElementById(e).querySelector("input"),r=t.dataTransfer.getData("fileIndex");o.removeFiles(n,r)}},H=(t,e,s)=>{let n=e.dataset,c=s.hasAttribute("multiple")&&s.getAttribute("multiple").toLowerCase()!=="false"?Object.prototype.hasOwnProperty.call(n,"maxFiles")?n.maxFiles:null:1,a=n.maxFileSize,p=n.maxSize,w=n.allowedExtensions?n.allowedExtensions.split(",").map(i=>i.replace(/^(\.)/,"")):null,E=0;if(c&&t.length>c)return M(e,"maxFiles",c),!1;for(let i=0;i<t.length;i++){let g=t[i].name.split(".");if(g?g=g.pop().toLowerCase():g="[none]",E+=t[i].size,a&&t[i].size>a)return M(e,"maxFileSize",a),!1;if(p&&E>p)return M(e,"maxSize",p),!1;if(w&&!w.includes(g))return M(e,"allowedExtensions",w.join(", ")),!1}return!0};for(let t=0;t<l.length;t++)(function(e){let s=e.closest("form"),n=e.querySelector('input[type="file"]');if(!(!n||e.classList.contains("no-js")||Object.prototype.hasOwnProperty.call(e.dataset,"filebokzId"))){if(o.count++,e.dataset.filebokzId=o.count,e.classList.add("js-enabled"),d&&!e.classList.contains(d)&&e.classList.add(d),N&&e.classList.add("is-advanced"),A&&e.classList.add("is-draggable"),e.id||(e.id="filebokz-"+o.count),e.dataset.allowedExtensions&&!n.getAttribute("accept")){let r=e.dataset.allowedExtensions.split(",").map(c=>c.replace(/^([^.])/,".$1"));n.setAttribute("accept",r.join(","))}e.addEventListener("dragover",function(r){P(r,e,n)},!1),e.addEventListener("dragenter",function(r){P(r,e,n)},!1),e.addEventListener("dragleave",function(r){Y(r,e,n)},!1),e.addEventListener("drop",function(r){G(r,e,n)},!1),n.addEventListener("change",function(r){C(r,e,n)},!1),n.addEventListener("focus",function(r){J(r,e)},!1),n.addEventListener("blur",function(r){W(r,e)},!1),s&&(e.dataset.autoSubmit&&e.dataset.autoSubmit.toLowerCase()!=="false"&&n.addEventListener("change",function(r){s.submit()},!1),s.addEventListener("reset",function(r){K(r,e,n)},!1),s.addEventListener("submit",function(r){Q(r,e)},!1)),C(new Event("change"),e,n)}})(l[t]);return window.addEventListener("dragover",function(t){V(t)},!1),window.addEventListener("drop",function(t){_(t)},!1),l};o.addFiles=(l,d)=>{let f=Array.from(l.files);f.concat(Array.from(d)),l.files=o.newFileList(f),o.triggerEvent("change",l)};o.newFileList=l=>{let d;try{d=new DataTransfer}catch{d=new ClipboardEvent("")}for(let f=0;f<l.length;f++)d.items.add(l[f]);return d.files};o.removeFiles=(l,d,f)=>{let b=Array.from(l.files);b.splice(d||0,f||1),l.files=o.newFileList(b),o.triggerEvent("change",l,{filebokzAction:"remove"})};o.triggerEvent=(l,d,f,b)=>setTimeout(function(){let z=new Event(l);for(let A in f)Object.prototype.hasOwnProperty.call(f,A)&&(z[A]=f[A]);d.dispatchEvent(z)},b||1);var U=o;U();
/*!
  filebokz v0.1.2 (https://github.com/kodie/filebokz)
  by Kodie Grantham (https://kodieg.com)
*/
